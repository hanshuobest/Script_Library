#coding:utf-8

from __future__ import print_function
import sys
reload(sys)
sys.setdefaultencoding('utf8')
import os
import glob
import xml.etree.cElementTree as ET
import argparse

CLASSES = [1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 , 28 , 29 , 30 , 31 , 32 , 33 , 34 , 35 , 36 , 37 , 38 , 39 , 40 , 41 , 42 , 43 , 44 , 45 , 46 , 47 , 48 , 49 , 50 , 51 , 52 , 53 , 54 , 55 , 56 , 57 , 58 , 59 , 60 , 61 , 62 , 63 , 64 , 65 , 66 , 67 , 68 , 69 , 70 , 71 , 72 , 73 , 74 , 75 , 76 , 77 , 78 , 79 , 80 , 81 , 82 , 83 , 84 , 85 , 86 , 87 , 88 , 89 , 90 , 91 , 92 , 93 , 94 , 95 , 96 , 97 , 98 , 99 , 100 , 101 , 102 , 103 , 104 , 105 , 106 , 107 , 108 , 109 , 110]

map_label_dict = {1: '7080069', 2: '33010108', 3: '33010109', 4: '33010110', 5: '33010111', 6: '33020040', 7: '33020041', 8: '33040087', 9: '33040088', 10: '33050153', 11: '33060206', 12: '33060207', 13: '33060208', 14: '34070296', 15: '35010266', 16: '35010267', 17: '36030382', 18: '37010231', 19: '37010232', 20: '37010233', 21: '40020209', 22: '66020053', 23: '76010011', 24: '76010012', 25: '76010013', 26: '76010014', 27: '87010001', 28: '87010002', 29: '87010004', 30: '87010005', 31: '87010006', 32: '87010007', 33: '87010008', 34: '87010009', 35: '87010010', 36: '87010011', 37: '87010012', 38: '87010013', 39: '87010014', 40: '87010015', 41: '87010016', 42: '87010017', 43: '87010018', 44: '87010019', 45: '87010020', 46: '87010021', 47: '87010022', 48: '87010023', 49: '87010024', 50: '87010025', 51: '87010026', 52: '87010027', 53: '87010028', 54: '87010029', 55: '87010030', 56: '87010031', 57: '87010032', 58: '87010033', 59: '87010034', 60: '87010035', 61: '87010036', 62: '87010037', 63: '87010038', 64: '87010039', 65: '87010040', 66: '87010041', 67: '87010042', 68: '87010043', 69: '87010044', 70: '87010045', 71: '87010046', 72: '87010047', 73: '87010048', 74: '87010049', 75: '87010050', 76: '87010051', 77: '87010052', 78: '87010053', 79: '87010054', 80: '87010055', 81: '87010056', 82: '87010057', 83: '87010058', 84: '87010059', 85: '87010060', 86: '87010061', 87: '87010062', 88: '87010063', 89: '87010064', 90: '87010065', 91: '87010066', 92: '87010067', 93: '87010068', 94: '87010069', 95: '87010070', 96: '87010071', 97: '87010072', 98: '87010073', 99: '87010074', 100: '87010075', 101: '87010076', 102: '87010077', 103: '87010078', 104: '87010079', 105: '87010080', 106: '87010081', 107: '87010083', 108: '87010084', 109: '87010085', 110: '87010086'}

inv_map_dict = {v:k for k , v in map_label_dict.items()}

def reconvert(xml_path):
	print(xml_path)
	et = ET.parse(xml_path)
	element = et.getroot()
	
	element_objs = element.findall('object')
	for element_obj in element_objs:
		class_name = element_obj.find('name').text
		# print(class_name)
		if class_name in inv_map_dict.keys():
			print(class_name)
			element_obj.find('name').text = str(inv_map_dict[class_name])
	et.write(xml_path)
	
if __name__ == '__main__':
#	parser = argparse.ArgumentParser()
#	parser.add_argument('--year')
#	args = parser.parse_args()
#	# xml_dir = u'/home/han/桌面/Anno/VOC2018/Annotations'
#	xml_dir = os.path.join(os.getcwd()[:-7] , 'VOC' + args.year + '/Annotations')
	xml_lsts = glob.glob(os.getcwd() + '/*.xml')
	for i in xml_lsts:
		reconvert(i)
	
